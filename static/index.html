<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listing Closer - Agent Learning Lab</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="main-container">
        <header>
            <h1>Listing Closer</h1>
            <p class="subtitle">Agent Learning Lab</p>
        </header>

        <div class="content-area">
            <!-- Left Panel: Chat -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="agent-badge" id="agent-badge">
                        <span class="agent-icon">?</span>
                        <div class="agent-info">
                            <span class="agent-name">Waiting...</span>
                            <span class="agent-style">Start a call</span>
                        </div>
                    </div>
                    <div class="turn-counter">
                        Turn: <span id="turn-count">0</span>/8
                    </div>
                </div>

                <div class="chat-window" id="chat-window">
                    <div class="chat-messages" id="chat-messages">
                        <div class="welcome-message">
                            <h3>Agent Learning Lab</h3>
                            <p>Watch AI agents learn to handle listing calls over time. Each call features:</p>
                            <ul>
                                <li>Random seller persona (motivation + property tier + potential red flags)</li>
                                <li>Random agent archetype that learns from past calls</li>
                                <li>Real-time sentiment and risk analysis</li>
                            </ul>
                            <p>Agents develop patterns from experience. Click "Start Call" to observe.</p>
                        </div>
                    </div>
                </div>

                <div class="stats-bar" id="stats-bar">
                    <span class="agent-score closer" title="Closer"><strong class="agent-score-icon">C</strong>: <span id="closer-points">0</span></span>
                    <span class="agent-score detective" title="Detective"><strong class="agent-score-icon">D</strong>: <span id="detective-points">0</span></span>
                    <span class="agent-score empath" title="Empath"><strong class="agent-score-icon">E</strong>: <span id="empath-points">0</span></span>
                    <span class="agent-score robot" title="Robot"><strong class="agent-score-icon">R</strong>: <span id="robot-points">0</span></span>
                    <span class="agent-score gambler" title="Gambler"><strong class="agent-score-icon">G</strong>: <span id="gambler-points">0</span></span>
                </div>

                <div class="button-row">
                    <button class="start-button" id="start-button">
                        Start Call
                    </button>
                    <button class="warmup-button" id="warmup-button">
                        Warmup Mode: OFF
                    </button>
                    <button class="leaderboard-button" id="leaderboard-button">
                        Leaderboard
                    </button>
                </div>
            </div>

            <!-- Right Panel: Dashboard -->
            <div class="dashboard-panel">
                <!-- Agent Confidence Section -->
                <div class="dashboard-section" id="confidence-section">
                    <h3>Agent Assessment</h3>
                    <div class="metric-group">
                        <div class="metric">
                            <span class="metric-label">Sketchy Risk</span>
                            <div class="metric-bar">
                                <div class="metric-fill fraud-fill" id="fraud-risk-bar" style="width: 30%"></div>
                            </div>
                            <span class="metric-value" id="fraud-risk-value">3/10</span>
                        </div>
                    </div>

                    <div class="motivation-guess">
                        <span class="metric-label">Motivation Read</span>
                        <div class="motivation-bars">
                            <div class="motivation-item">
                                <span class="motivation-label">HEAD</span>
                                <div class="motivation-bar">
                                    <div class="motivation-fill head-fill" id="head-bar" style="width: 33%"></div>
                                </div>
                                <span class="motivation-value" id="head-value">33%</span>
                            </div>
                            <div class="motivation-item">
                                <span class="motivation-label">HEART</span>
                                <div class="motivation-bar">
                                    <div class="motivation-fill heart-fill" id="heart-bar" style="width: 33%"></div>
                                </div>
                                <span class="motivation-value" id="heart-value">33%</span>
                            </div>
                            <div class="motivation-item">
                                <span class="motivation-label">HAND</span>
                                <div class="motivation-bar">
                                    <div class="motivation-fill hand-fill" id="hand-bar" style="width: 33%"></div>
                                </div>
                                <span class="motivation-value" id="hand-value">33%</span>
                            </div>
                        </div>
                    </div>

                    <div class="reasoning-box">
                        <span class="metric-label">Reasoning</span>
                        <p id="reasoning-text">Waiting for call to start...</p>
                    </div>
                </div>

                <!-- Customer Sentiment Section -->
                <div class="dashboard-section" id="sentiment-section">
                    <h3>Seller Sentiment</h3>
                    <div class="sentiment-grid">
                        <div class="sentiment-metric">
                            <span class="sentiment-label">Satisfaction</span>
                            <div class="sentiment-bar">
                                <div class="sentiment-fill satisfaction-fill" id="satisfaction-bar" style="width: 50%"></div>
                            </div>
                            <span class="sentiment-value" id="satisfaction-value">5</span>
                        </div>
                        <div class="sentiment-metric">
                            <span class="sentiment-label">Trust</span>
                            <div class="sentiment-bar">
                                <div class="sentiment-fill trust-fill" id="trust-bar" style="width: 50%"></div>
                            </div>
                            <span class="sentiment-value" id="trust-value">5</span>
                        </div>
                        <div class="sentiment-metric">
                            <span class="sentiment-label">Urgency</span>
                            <div class="sentiment-bar">
                                <div class="sentiment-fill urgency-fill" id="urgency-bar" style="width: 50%"></div>
                            </div>
                            <span class="sentiment-value" id="urgency-value">5</span>
                        </div>
                        <div class="sentiment-metric">
                            <span class="sentiment-label">Frustration</span>
                            <div class="sentiment-bar">
                                <div class="sentiment-fill frustration-fill" id="frustration-bar" style="width: 30%"></div>
                            </div>
                            <span class="sentiment-value" id="frustration-value">3</span>
                        </div>
                        <div class="sentiment-metric">
                            <span class="sentiment-label">Sign Likelihood</span>
                            <div class="sentiment-bar">
                                <div class="sentiment-fill likelihood-fill" id="likelihood-bar" style="width: 50%"></div>
                            </div>
                            <span class="sentiment-value" id="likelihood-value">5</span>
                        </div>
                    </div>
                    <div class="tone-display">
                        <span class="tone-label">Emotional Tone:</span>
                        <span class="tone-value" id="tone-value">neutral</span>
                    </div>
                </div>

                <!-- Frustration Warning -->
                <div class="frustration-warning" id="frustration-warning" style="display: none;">
                    <span class="warning-icon">!</span>
                    <span class="warning-text">High frustration - seller may leave!</span>
                </div>
            </div>
        </div>

        <!-- Leaderboard Modal -->
        <div class="modal-overlay" id="leaderboard-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Agent Leaderboard</h2>
                    <button class="modal-close" id="modal-close">&times;</button>
                </div>
                <div class="modal-body" id="leaderboard-content">
                    Loading...
                </div>
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>
